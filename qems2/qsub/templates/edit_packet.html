{% extends "base.html" %}

{% block header %}
{% include "header.html" %}
{% endblock %}

{% block sidebar %}
{% include "sidebar.html" %}
{% endblock %}

{% block content %}
{% load static %}
{% load filters %}
<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 text-left">
    <h2 class="page-header">Edit Packet {{ packet.packet_name }}</h2>
    {% if message %}
    <p class="{{ message_class }}">{{ message }}</p>
    {% endif %}

    <table class="table table-striped table-hover">
        <caption class="alert alert-info">
            <strong>Packet Completion Status</strong>
        </caption>
        <thead>
        <tr>
            <th>Tossup category</th>
            <th>Tossups required</th>
            <th>Tossups written</th>
            <th>Percent complete</th>
        </tr>
        </thead>
        <tbody>
        {% for cat, entry in tossup_status.items %}
        <tr>
            <td>
                {{ cat }}
            </td>
            <td>
                {{ entry.tu_req }}
            </td>
            <td>
                {{ entry.tu_in_cat }}
            </td>
            <td>
                {{ entry.tu_in_cat|percent:entry.tu_req }}
            </td>
        </tr>
        {% endfor %}
        </tbody>
        <thead>
        <tr>
            <th>Bonus Category</th>
            <th>Bonuses required</th>
            <th>Bonuses written</th>
            <th>Percent complete</th>
        </tr>
        </thead>
        <tbody>
        {% for cat, entry in bonus_status.items %}
        <tr>
            <td>
                {{ cat }}
            </td>
            <td>
                {{ entry.bs_req }}
            </td>
            <td>
                {{ entry.bs_in_cat }}
            </td>
            <td>
                {{ entry.bs_in_cat|percent:entry.bs_req }}
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>

    <table class="table table-striped table-hover">
        <caption class="alert alert-info">
            <strong>
                Current Tossups
            </strong>
        </caption>
        <thead>
        <tr>
            <th>Tossup Text</th>
            <th>Answer</th>
            <th>Category</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        {% for tossup in tossups %}
        <tr>
            <td>{{ tossup.tossup_text|preview }}</td>
            <td>{{ tossup.tossup_answer|preview }}</td>
            <td>{{ tossup.category }}</td>
            <td>
                <a href="/edit_tossup/{{ tossup.id }}" rel="tooltip" title="Edit tossup">
                    <i class="fa fa-edit"></i>
                </a>
                <a href="/delete_tossup/{{ tossup.id }}" rel="tooltip" title="Delete tossup" class="delete_tossup"
                   value="{{ tossup.id }}">
                    <i class="fa fa-minus-circle"></i>
                </a>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    <table class="table table-striped table-hover">
        <caption class="alert alert-info">
            <strong>
                Current Bonuses
            </strong>
        </caption>
        <thead>
        <tr>
            <th>Leadin</th>
            <th>Answers</th>
            <th>Category</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        {% for bonus in bonuses %}
        <tr>
            <td>{{ bonus.leadin|preview }}</td>
            <td>{{ bonus|bonus_answers }}</td>
            <td>{{ bonus.category }}</td>
            <td>
                <a href="/edit_bonus/{{ bonus.id }}" rel="tooltip" title="Edit tossup">
                    <i class="fa fa-edit"></i>
                </a>
                <a href="/delete_bonus/{{ bonus.id }}" rel="tooltip" title="Delete bonus" class="delete_bonus"
                   value="{{ bonus.id }}">
                    <i class="fa fa-minus-circle"></i>
                </a>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>

    <form action="" method="post">
        {% csrf_token %}
        {{ form.as_p }}
        {% if not read_only %}
        <input type="submit" value="Save"/>
        {% endif %}
    </form>
</div>

{% endblock %}
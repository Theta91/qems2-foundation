{% extends "base.html" %}

{% block header %}
{% include "header.html" %}
{% endblock %}

{% block sidebar %}
{% include "sidebar.html" %}
{% endblock %}

{% load filters %}
{% block content %}

<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 text-left">
    <h2 class="page-header">Upload Preview</h2>
    {% if message %}
    <div class="{{ message_class }}">
        {{ message }}
    </div>

    {% endif %}
    <form action="/complete_upload/" method="post">
        {% csrf_token %}
        <div class="col-md-8 col-md-offset-1 text-left">
            {% if tossup_errors %}
            {% for tu_error in tossup_errors %}
            <div class="alert alert-danger">
                {{ tu_error }}
            </div>
            {% endfor %}
            {% endif %}

            {% if bonus_errors %}
            {% for bs_error in bonus_errors %}
            <div class="alert alert-danger">
                {{ bs_error }}
            </div>
            {% endfor %}
            {% endif %}

            <h3>Submitted Tossups</h3>
            {% autoescape off %}
                {% for tossup in tossups %}
                <p>{{ tossup.question|safe|question_html }}<br>
                    {{ tossup.answer|safe|answer_html }} 
                    {% if tossup.category != '' %}
                        &#123;{{ tossup.category|safe}}&#125;
                    {% endif %}
                </p>
                <input type="hidden" name="tossup-text-{{ forloop.counter0 }}" value="{{ tossup.question|safe }}">
                <input type="hidden" name="tossup-answer-{{ forloop.counter0 }}" value="{{ tossup.answer|safe }}"> 
                <input type="hidden" name="tossup-category-{{ forloop.counter0 }}" value="{{ tossup.category|safe }}">
                {% endfor %}
            {% endautoescape %}
                
            <h3>Submitted Bonuses</h3>
            {% autoescape off %}
                {% for bonus in bonuses %}
                <p>{{ bonus.leadin|safe|question_html }}<br>
                    [{{ bonus.values.0 }}]
                    {{ bonus.parts.0|safe|question_html }}<br>
                    {{ bonus.answers.0|safe|answer_html }}<br>
                    [{{ bonus.values.1 }}]
                    {{ bonus.parts.1|safe|question_html }}<br>
                    {{ bonus.answers.1|safe|answer_html }}<br>
                    [{{ bonus.values.2 }}]
                    {{ bonus.parts.2|safe|question_html }}<br>
                    {{ bonus.answers.2|safe|answer_html }}<br>
                    Type: {{ bonus.type|safe}}<br>
                    {% if bonus.category != '' %}
                        Category: {{ bonus.category|safe}} <br>
                    {% endif %}
                </p>

                <input type="hidden" name="bonus-leadin-{{ forloop.counter0 }}" value="{{ bonus.leadin|safe }}">
                <input type="hidden" name="bonus-category-{{ forloop.counter0 }}" value="{{ bonus.category|safe }}">
                <input type="hidden" name="bonus-type-{{ forloop.counter0 }}" value="{{ bonus.type|safe }}">            
                <input type="hidden" name="bonus-part1-{{ forloop.counter0 }}" value="{{ bonus.parts.0|safe }}">
                <input type="hidden" name="bonus-answer1-{{ forloop.counter0 }}" value="{{ bonus.answers.0|safe }}">
                <input type="hidden" name="bonus-part2-{{ forloop.counter0 }}" value="{{ bonus.parts.1|safe }}">
                <input type="hidden" name="bonus-answer2-{{ forloop.counter0 }}" value="{{ bonus.answers.1|safe }}">
                <input type="hidden" name="bonus-part3-{{ forloop.counter0 }}" value="{{ bonus.parts.2|safe }}">
                <input type="hidden" name="bonus-answer3-{{ forloop.counter0 }}" value="{{ bonus.answers.2|safe }}">

                {% endfor %}
            {% endautoescape %}

            <input type="hidden" name="num-tossups" value="{{ tossups|length }}">
            <input type="hidden" name="num-bonuses" value="{{ bonuses|length }}">
            <input type="hidden" name="qset-id" value="{{ qset.id }}">
            <input type="submit" class="btn btn-primary" value="Submit"/>
            <a href="/edit_question_set/{{ qset.id }}" class="btn btn-primary">Cancel</a>
        </div>
    </form>
</div>

{% endblock %}
